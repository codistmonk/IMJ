<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_imj_jar" name="Create Jar for Project IMJ">
    <!--ANT 1.7 is required                                        -->
    <target name="create_imj_jar">
    	<exec executable="svnversion" output="src/imj/version" logError="true"/>
        <jar destfile="imj-all.jar" filesetmanifest="mergewithoutmain">
            <manifest>
                <attribute name="Class-Path" value="."/>
            </manifest>
            <fileset file="imj_license.txt"/>
            <fileset file="readme.txt"/>
            <fileset dir="bin" excludes="**/*Test*.*">
            	<present present="srconly" targetdir="test"/>
        	</fileset>
            <fileset dir="src"/>
            <zipfileset excludes="META-INF/*.SF" src="lib/aprog.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="lib/loci_tools.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="lib/ojalgo-33.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="lib/jsch-0.1.50.jar"/>
        </jar>
        <jar destfile="imj.jar" filesetmanifest="mergewithoutmain">
            <manifest>
                <attribute name="Class-Path" value="."/>
            </manifest>
            <fileset file="imj_license.txt"/>
            <fileset file="readme.txt"/>
            <fileset dir="bin" excludes="**/*Test*.*">
            	<present present="srconly" targetdir="test"/>
        	</fileset>
            <fileset dir="src"/>
        </jar>
    	<delete file="src/imj/version"/>
    </target>
</project>
